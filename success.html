<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨‚è³¼æˆåŠŸ | å¸ƒå¶æ—¥å’Œ</title>
    <link rel="icon" href="logo.png" type="image/png">
    <style>
        @font-face { font-family: 'OpenHuninn'; src: url('jf-openhuninn-2.0.ttf') format('truetype'); }
        body { font-family: 'OpenHuninn', sans-serif; background-color: #f7e1ea; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 20px; box-sizing: border-box; }
        .card { background: #ffffff; padding: 40px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 500px; text-align: center; }
        h1 { color: #e493b3; margin-bottom: 10px; }
        .icon { font-size: 4rem; margin-bottom: 20px; display: block; }
        
        .reminder-box { background: #e3f2fd; border: 2px solid #90caf9; color: #1565c0; padding: 15px; border-radius: 10px; margin: 20px 0; text-align: left; display: none; }
        .reminder-title { font-weight: bold; font-size: 1.1rem; margin-bottom: 5px; }

        .receipt { background: #fffafa; border: 2px dashed #e493b3; padding: 20px; border-radius: 10px; margin: 20px 0; text-align: left; }
        .receipt-title { font-weight: bold; border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px; color: #555; }
        .receipt-item { display: flex; justify-content: space-between; font-size: 0.95rem; margin-bottom: 8px; color: #666; }
        .receipt-total { display: flex; justify-content: space-between; font-weight: bold; font-size: 1.1rem; border-top: 1px solid #eee; padding-top: 10px; margin-top: 10px; color: #e493b3; }
        
        /* å‚™è¨»é¡¯ç¤ºå€å¡Š */
        .receipt-note { margin-top: 15px; padding-top: 10px; border-top: 1px dashed #eee; font-size: 0.9rem; color: #777; }
        .receipt-note strong { color: #555; }

        .btn { display: inline-block; margin-top: 10px; text-decoration: none; background: #e493b3; color: white; padding: 12px 30px; border-radius: 50px; font-weight: bold; }
    </style>
</head>
<body>
    <div class="card">
        <span class="icon">ğŸ‰</span>
        <h1 id="pageTitle">å®Œæˆè¨‚å–®ï¼</h1>
        <p id="subText">æ„Ÿè¬æ‚¨çš„è³¼è²·ï¼Œæˆ‘å€‘å·²æ”¶åˆ°æ‚¨çš„è³‡è¨Šã€‚</p>

        <div id="bookingReminder" class="reminder-box">
            <div class="reminder-title">ğŸ“… é ç´„æé†’</div>
            <p style="margin: 0;">è«‹å‹™å¿…è¨˜å¾—æ–¼ <strong><span id="reminderDate"></span></strong> å‰å¾€å·¥ä½œå®¤ã€‚</p>
            <p style="margin: 5px 0 0 0; font-size: 0.9rem; opacity: 0.8;">ç¢ºèªä¿¡å·²ç™¼é€è‡³ï¼š<span id="reminderEmail"></span></p>
        </div>

        <div class="receipt">
            <div class="receipt-title">è¨‚å–®æ˜ç´°</div>
            <div id="receiptList"></div>
            
            <div id="noteDisplay" class="receipt-note" style="display:none;">
                <strong>å‚™è¨»ï¼š</strong><br><span id="noteText"></span>
            </div>

            <div class="receipt-total">
                <span>ç¸½è¨ˆ</span>
                <span id="receiptTotal">NT$ 0</span>
            </div>
        </div>

        <a href="index.html" class="btn">è¿”å›é¦–é </a>
    </div>

    <script>
        const lastOrder = JSON.parse(localStorage.getItem('lastOrder'));
        
        if (lastOrder) {
            const listDiv = document.getElementById('receiptList');
            const reminderBox = document.getElementById('bookingReminder');

            // 1. é ç´„æé†’é‚è¼¯
            if (lastOrder.isBooking) {
                reminderBox.style.display = 'block';
                document.getElementById('reminderDate').innerText = lastOrder.bookingDate;
                document.getElementById('reminderEmail').innerText = lastOrder.contactEmail;
                
                if (lastOrder.total === 0) {
                    document.getElementById('pageTitle').innerText = "é ç´„æˆåŠŸï¼";
                    document.getElementById('subText').innerText = "æ‚¨çš„è«®è©¢å·²é ç´„å®Œæˆï¼Œç„¡éœ€äº‹å…ˆä»˜æ¬¾ã€‚";
                    reminderBox.style.background = "#fff8e1"; 
                    reminderBox.style.borderColor = "#ffe082";
                    reminderBox.style.color = "#d84315";
                }
            }

            // 2. é¡¯ç¤ºæ¸…å–®
            let html = '';
            if (lastOrder.items && lastOrder.items.length > 0) {
                lastOrder.items.forEach(item => {
                    html += `
                    <div class="receipt-item">
                        <span>${item.name}</span>
                        <span>$${item.price}</span>
                    </div>`;
                });
            } else {
                html = '<div style="text-align:center;color:#ccc;">ç„¡æ˜ç´°è³‡æ–™</div>';
            }
            listDiv.innerHTML = html;
            
            // 3. â˜…â˜…â˜… é¡¯ç¤ºå‚™è¨» (å¦‚æœæœ‰) â˜…â˜…â˜…
            if (lastOrder.note && lastOrder.note.trim() !== "") {
                document.getElementById('noteDisplay').style.display = 'block';
                document.getElementById('noteText').innerText = lastOrder.note;
            }

            document.getElementById('receiptTotal').innerText = `NT$ ${lastOrder.total}`;
        }
    </script>
</body>
</html>